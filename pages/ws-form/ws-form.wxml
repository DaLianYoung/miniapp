<view class="page">
    <view class="page__bd">
        <view class="weui-cells__title">物损工单</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">事故区域</view>
                </view>
                <view class="weui-cell__bd" wx:if="{{id == null}}">
                    <view class="picker weui-select weui-select_in-select-after" bindtap="openLocation">{{regionLabel ? regionLabel : '请填写地址'}}</view>
                </view>
                <view class="weui-cell__bd" wx:if="{{id != null}}">
                    <text class="weui-input readonly">{{regionLabel || '-'}}</text>
                </view>
            </view>
            <view class="weui-cell weui-cell_input">
                <view class="weui-cell__hd">
                    <view class="weui-label">受损人姓名</view>
                </view>
                <view class="weui-cell__bd" wx:if="{{id == null}}">
                    <input class="weui-input" bindinput="inputgetName" data-name='taskData.damagedUser'
                           value="{{taskData.damagedUser}}" placeholder="受损人姓名"/>
                </view>
                <view class="weui-cell__bd" wx:if="{{id != null}}">
                    <text class="weui-input readonly">{{taskData.damagedUser || '-'}}</text>
                </view>
            </view>
            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">受损人手机</view>
                </view>
                <view class="weui-cell__bd" wx:if="{{id == null}}">
                    <input class="weui-input" bindinput="inputgetName" data-name='taskData.damagedPhone'
                           value="{{taskData.damagedPhone}}" placeholder="请输入受损人手机"/>
                </view>
                <view class="weui-cell__bd" wx:if="{{id != null}}">
                    <text class="weui-input readonly">{{taskData.damagedPhone || '-'}}</text>
                </view>
                <view class="weui-cell__ft" wx:if="{{id != null}}">
                    <view class="field-right-btn" data-phone="{{taskData.damagedPhone}}" bindtap="dialPhone">
                        <van-icon name="phone"></van-icon>
                    </view>
                </view>
            </view>
            <view class="weui-cell weui-cell_input">
                <view class="weui-cell__hd">
                    <view class="weui-label">客户姓名</view>
                </view>
                <view class="weui-cell__bd">
                    <input class="weui-input" bindinput="inputgetName" data-name='taskData.customerUser'
                           value="{{taskData.customerUser}}" placeholder="客户姓名"/>
                </view>
            </view>
            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">客户手机</view>
                </view>
                <view class="weui-cell__bd">
                    <input class="weui-input" bindinput="inputgetName" data-name='taskData.customerPhone'
                           value="{{taskData.customerPhone}}" placeholder="请输入客户手机"/>
                </view>
                <view class="weui-cell__ft" wx:if="{{id != null}}">
                    <view class="field-right-btn" data-phone="{{taskData.customerPhone}}" bindtap="dialPhone">
                        <van-icon name="phone"></van-icon>
                    </view>
                </view>
            </view>
            <view class="weui-cell weui-cell_select">
                <view class="weui-cell__hd weui-cell__hd_in-select-after">
                    <view class="weui-label">险种</view>
                </view>
                <view class="weui-cell__bd" wx:if="{{id == null}}">
                    <van-radio-group value="{{ taskData.insuranceType }}" custom-class="weui-input vertical"
                                     bind:change="oninsuranceTypeChange">
                        <van-radio custom-class="fl mr5" name="1">车物损</van-radio>
                        <van-radio custom-class="fl mr5" name="2">非车</van-radio>
                    </van-radio-group>
                </view>
                <view class="weui-cell__bd" wx:if="{{id != null}}">
                    <text class="weui-input readonly">{{taskData.insuranceType == 1 ? '车物损' : '非车'}}</text>
                </view>
            </view>
            <view class="weui-cell weui-cell_input weui-cell_vcode" wx:if="{{taskData.insuranceType == '1'}}">
                <view class="weui-cell__hd">
                    <view class="weui-label">车牌号</view>
                </view>
                <view class="weui-cell__bd" wx:if="{{id == null}}">
                    <input class="weui-input" bindinput="inputgetName" data-name='taskData.plateNumber'
                           value="{{taskData.plateNumber}}" placeholder="请输入车牌号"/>
                </view>
                <view class="weui-cell__bd" wx:if="{{id != null}}">
                    <text class="weui-input readonly">{{taskData.plateNumber || '-'}}</text>
                </view>
            </view>
        </view>
        <view class="weui-cells__title">报案信息</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell">
                <view class="weui-cell__bd" wx:if="{{!show}}">
                    <textarea class="weui-textarea" bindinput="inputgetName" data-name='taskData.information'
                              value="{{taskData.information}}" disabled="{{id !== null}}" placeholder="请输入文本" style="height: 3.3em"/>
                </view>
                <view class="weui-cell__bd" style="height: 3.3em" wx:if="{{show}}">
                    {{taskData.information}}
                </view>
            </view>
        </view>
        <!-- upload start-->
        <view class="weui-cells__title">报案信息图片</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell">
                <view class="weui-cell__bd">
                    <view class="weui-uploader">
                        <view class="weui-uploader__bd">
                            <view class="weui-uploader__files" id="uploaderFiles">
                                <block wx:for="{{informationImageFiles}}" wx:key="*this">
                                    <view class="weui-uploader__file image-preview-wrap" bindtap="previewImage" id="{{item}}">
                                        <image class="weui-uploader__img" src="{{item}}" mode="aspectFill"/>
                                        <van-icon wx:if="{{id == null}}" catchtap="removeinformationImageFiles" data-index="{{index}}" name="clear" custom-class="delete-image-icon"></van-icon>
                                    </view>
                                </block>
                            </view>
                            <view class="weui-uploader__input-box" wx:if="{{id == null}}">
                                <view class="weui-uploader__input" bindtap="chooseImage"></view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <!-- upload end-->
        <view class="weui-cells__title">现场信息</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell">
                <view class="weui-cell__bd" wx:if="{{!show}}">
                    <textarea class="weui-textarea" bindinput="inputgetName" data-name='taskData.live'
                              value="{{taskData.live}}" disabled="{{id !== null}}" placeholder="请输入文本" style="height: 3.3em"/>
                </view>
                <view class="weui-cell__bd" style="height: 3.3em" wx:if="{{show}}">
                    {{taskData.information}}
                </view>
            </view>
        </view>
        <!-- upload start-->
        <view class="weui-cells__title">现场信息图片</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell">
                <view class="weui-cell__bd">
                    <view class="weui-uploader">
                        <view class="weui-uploader__bd">
                            <view class="weui-uploader__files" id="uploaderFiles">
                                <block wx:for="{{liveImageFiles}}" wx:key="*this">
                                    <view class="weui-uploader__file image-preview-wrap" bindtap="previewImageForliveImageFiles" id="{{item}}">
                                        <image class="weui-uploader__img" src="{{item}}" mode="aspectFill"/>
                                        <van-icon wx:if="{{id == null}}" catchtap="removeliveImageFiles" data-index="{{index}}" name="clear" custom-class="delete-image-icon"></van-icon>
                                    </view>
                                </block>
                            </view>
                            <view class="weui-uploader__input-box" wx:if="{{id == null}}">
                                <view class="weui-uploader__input" bindtap="chooseImageForliveImageFiles"></view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <!-- upload end-->
        #{{role}} | {{taskData.status}}#
        <!-- 需要 权限控制的字段 start -->
        <block wx:if="{{(role == 6||role == 11||role == 12) && id != null}}">
            <view class="weui-cells__title">查勘员信息</view>
            <view class="weui-cells weui-cells_after-title">
                <view class="weui-cell weui-cell_input">
                    <view class="weui-cell__hd">
                        <view class="weui-label">查勘员姓名</view>
                    </view>
                    <view class="weui-cell__bd">
                        <text class="weui-input readonly">{{taskData.surveyUser || '-'}}</text>
                    </view>
                </view>
                <view class="weui-cell weui-cell_input weui-cell_vcode">
                    <view class="weui-cell__hd">
                        <view class="weui-label">查勘员手机</view>
                    </view>
                    <view class="weui-cell__bd">
                        <text class="weui-input readonly">{{taskData.surveyPhone || '-'}}</text>
                    </view>
                </view>
            </view>
        </block>

        <block wx:if="{{(role == 6||role == 11||role == 12) && id != null}}">
            <view class="weui-cells__title">施工方信息</view>
            <view class="weui-cells weui-cells_after-title">
                <view class="weui-cell weui-cell_input">
                    <view class="weui-cell__hd">
                        <view class="weui-label">施工方姓名</view>
                    </view>
                    <view class="weui-cell__bd">
                        <text class="weui-input readonly">{{taskData.workerUser || '-'}}</text>
                    </view>
                </view>
                <view class="weui-cell weui-cell_input weui-cell_vcode">
                    <view class="weui-cell__hd">
                        <view class="weui-label">施工方手机</view>
                    </view>
                    <view class="weui-cell__bd">
                        <text class="weui-input readonly">{{taskData.workerPhone || '-'}}</text>
                    </view>
                </view>
            </view>
        </block>

        <view class="weui-cells" wx:if="{{(role == 6||role == 11||role == 12) && id != null}}">
            <view class="weui-cell weui-cell_select">
                <view class="weui-cell__hd weui-cell__hd_in-select-after">
                    <view class="weui-label">处理方式</view>
                </view>
                <!--当 status 1 查勘员已派送 并且 角色 为 施工员人员 可编辑-->
                <view class="weui-cell__bd" wx:if="{{ taskData.status == 1 && role == 12 }}">
                    <van-radio-group value="{{ taskData.workType }}" custom-class="weui-input vertical"
                                     bind:change="onworkTypeChange">
                        <van-radio custom-class="fl mr5" name="0">咨询</van-radio>
                        <van-radio custom-class="fl mr5" name="1">去现场</van-radio>
                    </van-radio-group>
                </view>
                <view class="weui-cell__bd" wx:else>
                    <text class="weui-input readonly">{{['咨询', '去现场'][taskData.workType]}}</text>
                </view>
            </view>
            <!--当 选择 咨询  并且 查勘员现场图片不为空 或者 工单状态为已完善 -->
            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">初步估损金额</view>
                </view>
                <view class="weui-cell__bd">
                    <input class="weui-input" placeholder=""/>
                </view>
            </view>
        </view>
        <!-- upload start-->
        <view class="weui-cells__title">现场信息图片（施工方）</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell">
                <view class="weui-cell__bd">
                    <view class="weui-uploader">
                        <view class="weui-uploader__bd">
                            <view class="weui-uploader__files" id="uploaderFiles">
                                <block wx:for="{{files}}" wx:key="*this">
                                    <view class="weui-uploader__file" bindtap="previewImage" id="{{item}}">
                                        <image class="weui-uploader__img" src="{{item}}" mode="aspectFill"/>
                                        <text>Delete!!</text>
                                    </view>
                                </block>
                            </view>
                            <view class="weui-uploader__input-box">
                                <view class="weui-uploader__input" bindtap="chooseImage"></view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <!-- upload end-->
        <!-- upload start-->
        <view class="weui-cells__title">损失清单</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell">
                <view class="weui-cell__bd">
                    <view class="weui-uploader">
                        <view class="weui-uploader__bd">
                            <view class="weui-uploader__files" id="uploaderFiles">
                                <block wx:for="{{files}}" wx:key="*this">
                                    <view class="weui-uploader__file" bindtap="previewImage" id="{{item}}">
                                        <image class="weui-uploader__img" src="{{item}}" mode="aspectFill"/>
                                        <text>Delete!!</text>
                                    </view>
                                </block>
                            </view>
                            <view class="weui-uploader__input-box">
                                <view class="weui-uploader__input" bindtap="chooseImage"></view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <!-- upload end-->
        <view class="weui-cells__title"></view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell weui-cell_select">
                <view class="weui-cell__hd weui-cell__hd_in-select-after">
                    <view class="weui-label">施工方式</view>
                </view>
                <view class="weui-cell__bd">
                    <picker bindchange="bindPickerChange" value="{{companyCategory}}" range="{{companyCategoryList}}">
                        <view class="picker weui-select weui-select_in-select-after">
                            {{companyCategoryList[companyCategory]}}
                        </view>
                    </picker>
                </view>
            </view>
            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">押金金额</view>
                </view>
                <view class="weui-cell__bd">
                    <input class="weui-input" placeholder="请输入押金金额"/>
                </view>
            </view>
            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">银行交易单号</view>
                </view>
                <view class="weui-cell__bd">
                    <input class="weui-input" placeholder="请输入银行交易单号"/>
                </view>
            </view>
        </view>

        <!-- upload start-->
        <view class="weui-cells__title">押金/授权</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell">
                <view class="weui-cell__bd">
                    <view class="weui-uploader">
                        <view class="weui-uploader__bd">
                            <view class="weui-uploader__files" id="uploaderFiles">
                                <block wx:for="{{files}}" wx:key="*this">
                                    <view class="weui-uploader__file" bindtap="previewImage" id="{{item}}">
                                        <image class="weui-uploader__img" src="{{item}}" mode="aspectFill"/>
                                        <text>Delete!!</text>
                                    </view>
                                </block>
                            </view>
                            <view class="weui-uploader__input-box">
                                <view class="weui-uploader__input" bindtap="chooseImage"></view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <!-- upload end-->
        <view class="weui-cells__title"></view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">报价金额</view>
                </view>
                <view class="weui-cell__bd">
                    <input class="weui-input" placeholder="报价金额"/>
                </view>
            </view>

            <view class="weui-cell weui-cell_input weui-cell_vcode">
                <view class="weui-cell__hd">
                    <view class="weui-label">报价人员</view>
                </view>
                <view class="weui-cell__bd">
                    <input class="weui-input" placeholder="报价人员"/>
                </view>
            </view>
        </view>

        <view class="weui-cells__title">报价备注</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell">
                <view class="weui-cell__bd">
                    <textarea class="weui-textarea" placeholder="请输入文本" style="height: 3.3em"/>
                </view>
            </view>
        </view>

        <!-- upload start-->
        <view class="weui-cells__title">施工完成信息</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell">
                <view class="weui-cell__bd">
                    <view class="weui-uploader">
                        <view class="weui-uploader__bd">
                            <view class="weui-uploader__files" id="uploaderFiles">
                                <block wx:for="{{files}}" wx:key="*this">
                                    <view class="weui-uploader__file" bindtap="previewImage" id="{{item}}">
                                        <image class="weui-uploader__img" src="{{item}}" mode="aspectFill"/>
                                        <text>Delete!!</text>
                                    </view>
                                </block>
                            </view>
                            <view class="weui-uploader__input-box">
                                <view class="weui-uploader__input" bindtap="chooseImage"></view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <!-- upload end-->
        <!-- upload start-->
        <view class="weui-cells__title">保险计算书</view>
        <view class="weui-cells weui-cells_after-title">
            <view class="weui-cell">
                <view class="weui-cell__bd">
                    <view class="weui-uploader">
                        <view class="weui-uploader__bd">
                            <view class="weui-uploader__files" id="uploaderFiles">
                                <block wx:for="{{files}}" wx:key="*this">
                                    <view class="weui-uploader__file" bindtap="previewImage" id="{{item}}">
                                        <image class="weui-uploader__img" src="{{item}}" mode="aspectFill"/>
                                        <text>Delete!!</text>
                                    </view>
                                </block>
                            </view>
                            <view class="weui-uploader__input-box">
                                <view class="weui-uploader__input" bindtap="chooseImage"></view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
        <!-- upload end-->
        <!-- 需要 权限控制的字段  end -->
        <view class="button-sp-area two-btn-wrap">
            <button type="primary" bindtap="submitWS">提交</button>
            <button>暂存</button>
        </view>
    </view>
    <van-popup
            show="{{ show }}"
            position="bottom"
            overlay="{{ true }}"
    >
        <van-area area-list="{{ areaList }}" value="{{ region }}" bind:confirm="onConfirm" bind:cancel="onCancel"/>
    </van-popup>
</view>